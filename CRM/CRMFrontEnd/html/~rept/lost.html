<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>jb-aptech毕业设计项目-----客户流失分析</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<link href="../css/style.css" rel="stylesheet" type="text/css">
<script src="../script/common.js"></script>
	<script type="text/javascript" src="../js/jquery-1.12.4.js"></script>
	<script type="text/javascript">
		$(function(){
			showList();
		})

		function showList(){
			var pageno=$("#spageno").val();
			var pagesize=$("#spagesize").val();
			var lst_cust_name=$("#scust_name").val();
			var lst_manager_name=$("#scust_manage_name").val();
			var lst_status=$("#scust_status").val();
			var data="{lst_cust_name:\""+lst_cust_name+"\",lst_manager_name:\""+lst_manager_name+"\",lst_status:\""+lst_status+"\",pageno:\""+pageno+"\",pagesize:\""+pagesize+"\"}";
			var str="<tr><th height=\"28\">编号</th><th height=\"28\">年份</th><th height=\"28\">客户</th><th height=\"28\">客户经理</th><th height=\"28\">流失原因</th></tr>";
			$.ajax({
				url:"http://localhost:7701/findAllLostCust",
				type:"post",
				data:data,
				contentType:"application/json;charset=utf-8",
				success:function(obj){
					if(obj!=null){
						for(var i=0;i<obj.length;i++){
							str+="<tr>"+
									"<td class=\"list_data_number\" height=\"27\">"+obj[i].lst_id+"</td>"+
									"<td class=\"list_data_text\" height=\"27\">"+obj[i].lostyear+"</td>"+
									"<td class=\"list_data_text\" height=\"27\">"+obj[i].lst_cust_name+"</td>"+
									"<td class=\"list_data_text\" height=\"27\">"+obj[i].lst_manager_name+"</td>"+
									"<td class=\"list_data_ltext\" height=\"27\">"+obj[i].lst_reason+"</td>"+
									"</tr>";
						}
						str+="<tr>"+
								"<th colspan=\"7\" class=\"pager\">"+
								"<div class=\"pager\">"+
								"共<span id=\"totleRecord\">"+obj[0].countrecord+"</span>条记录 每页<input value=\""+obj[0].pagesize+"\" size=\"2\" id=\"pageSize\" />条"+
									"第<input value=\""+obj[0].pageno+"\" size=\"2\" id=\"pageNo\"/>页/共<span id=\"countPage\">"+obj[0].countpage+"</span>页"+
								"<a><span onclick='firstPage();'>第一页</span></a>"+
								"<a><span onclick='upPage();'>上一页</span></a>"+
								"<a><span onclick='nextPage();'>下一页</span></a>"+
								"<a><span onclick='lastPage();'>最后一页</span></a>"+
								"转到<input value=\""+obj[0].pageno+"\" size=\"2\" id='targetPage' />页"+
								"<button width=\"20\" onclick='targetPage();' >GO</button>"+
								"</div>"+
								"</th>"+
								"</tr>";
					}
					$("#spageno").val(obj[0].pageno);
					$("#spagesize").val(obj[0].pagesize);
					$(".data_list_table").html(str);
				},
				error:function(){
					$(".data_list_table").html("<p align='center' style='margin-top: 100px;font-size: 30px;color: red;font-style: italic'>抱歉，没有符合您需要的数据，请重新查询</p>");
				}
			})
		}

		//点击查询时执行
		function searchChance(){
			showList();

		}

		//点击第一页
		function firstPage(){
			/*alert($("#c_pageNo").val());
			 alert($("#c_pageSize").val());*/
			$("#spageno").val(1);
			showList();
		}
		//点击上一页
		function upPage(){
			/*alert($("#c_pageNo").val());
			 alert($("#c_pageSize").val());*/
			var pageNo=$("#pageNo").val()
			var pageSize=$("#pageSize").val();
			$("#spageno").val(pageNo-1);
			$("#spagesize").val(pageSize);
			showList();
		}

		//点击下一页
		function nextPage(){
			/*alert($("#c_pageNo").val());
			 alert($("#c_pageSize").val());*/
			var pageNo=$("#pageNo").val();
			var newPageNo=parseInt(pageNo)+parseInt(1);
			var pageSize=$("#pageSize").val();
			$("#spageno").val(newPageNo);
			$("#spagesize").val(pageSize);
			showList();
		}

		//点击最后一页
		function lastPage(){
			/*alert($("#c_pageNo").val());
			 alert($("#c_pageSize").val());*/
			var pageNo=$("#countPage").html()
			var pageSize=$("#pageSize").val();
			$("#spageno").val(pageNo);
			$("#spagesize").val(pageSize);
			showList();
		}


		//点击跳转页
		function targetPage(){
			/*alert($("#c_pageNo").val());
			 alert($("#c_pageSize").val());*/
			var pageNo=$("#targetPage").val()
			var pageSize=$("#pageSize").val();
			$("#spageno").val(pageNo);
			$("#spagesize").val(pageSize);
			showList();
		}

	</script>


</head>
<body>

<div class="page_title">客户流失分析</div>
<div class="button_bar">
	<button class="common_button" onclick="help('');">帮助</button>
	<button class="common_button" onclick="searchChance();">查询</button>
	</div>
	<table class="query_form_table" border="0" cellPadding="3" cellSpacing="0">
		<tr>
			<th>客户名称</th>
			<td><input type="text" name="item.lstCustName" value="" id="scust_name"></td>
			<th>客户经理</th>
			<td><input type="text" name="item.lstCustManagerName" value="" id="scust_manage_name"></td>
			<th>状态</th>
			<td>
				<select id="scust_status">
					<option value="全部">全部</option>
					<option>预警</option>
					<option>暂缓流失</option>
					<option>已经流失</option>
				</select>
			</td>
		</tr>
	</table><br />
	<table class="data_list_table">
		<!--<tr>
			<th height="28">编号</th>
			<th height="28">年份</th>
			<th height="28">客户</th>
			<th height="28">客户经理</th>
			<th height="28">流失原因</th>
		</tr>
		<tr>
			<td class="list_data_number" height="27">1</td>
			<td class="list_data_text" height="27">2006</td>
			<td class="list_data_text" height="27">大空纶纺</td>
			<td class="list_data_text" height="27">小满</td>
			<td class="list_data_ltext" height="27">客户厂址迁移</td>
	</tr>
	<tr>
		<td class="list_data_number">2</td>
		<td class="list_data_text">2006</td>
		<td class="list_data_text">星星广告</td>
		<td class="list_data_text">郭小美</td>
		<td class="list_data_ltext">客户公司被收购</td>
	</tr>
	<tr>
		<td class="list_data_number">3</td>
		<td class="list_data_text">2005</td>
		<td class="list_data_text">和满记餐饮</td>
		<td class="list_data_text">周结论</td>
		<td class="list_data_ltext">没有采购需求</td>
	</tr>
	<tr>
		<th colspan="7" class="pager">
<div class="pager">
	共59条记录 每页<input value="10" size="2" />条
	第<input value="1" size="2"/>页/共5页
	<a href="#">第一页</a>
	<a href="#">上一页</a>
	<a href="#">下一页</a>
	<a href="#">最后一页</a>
	转到<input value="1" size="2" />页
	<button width="20" onclick="reload();">GO</button>
</div>
		</th>
	</tr>
-->
	</table>
	<input type="hidden" id="spageno"/><input type="hidden" id="spagesize"/>
</body>
</html>